C++ Templates 核心知识点总结（精简文档版）
一、SFINAE
全称：Substitution Failure Is Not An Error
含义：替换失败并非错误
作用：模板重载匹配时，替换失败不报错，编译器继续寻找合法重载，用于类型检测、条件启用模板。
二、模板链接错误与包含模型
链接错误原因：模板声明与定义分在不同编译单元，编译器无法实例化。
最优方案：模板完整定义直接放在头文件（包含模型）。
包含模型：
优点：无链接错误、使用简单、支持任意类型。
缺点：引入大量头文件依赖，编译变慢。
优化：预编译头 PCH、显式实例化、C++20 Modules。
三、inline 与模板
inline 唯一保证效果：允许函数在多个翻译单元定义。
内联展开只是编译器优化提示，可被忽略。
普通模板放头文件不需要 inline。
函数模板全特化 = 普通函数：类外头文件定义必须加 inline。
四、预编译头 PCH
原理：将公共头文件编译为编译器状态快照，避免重复解析。
优点：显著提升大型项目编译速度。
使用关键：所有 .cpp 以相同公共头文件开头。
核心局限：宏干扰
宏全局、动态、顺序敏感；PCH 静态固化，无法适应宏变化。
无法实现多文件、细粒度 PCH。
五、分离模型（export 模板）
C++98 设计目标：模板声明放头文件，定义放 .cpp。
实现复杂，几乎无编译器支持。
C++11 已移除，无实用价值。
六、模板编译错误
特点：信息冗长、嵌套深、报错位置不直观。
阅读技巧：从下往上看，先看 error，再通过 in instantiation 回溯调用点。
七、实用最佳实践
模板定义一律放在头文件。
仅模板全特化在类外头文件定义时需要 inline。
编译慢使用 PCH，C++20 优先使用 Modules。
排查模板错误：追踪实例化链。